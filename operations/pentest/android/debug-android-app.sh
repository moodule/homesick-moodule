#!/bin/bash

TARGET=com.getpure.pure

# solve issue in adb
# run-as: Package 'com.mypackage' is not debuggable

# find the package in the list
# it should look something like /data/app/com.mypackage.apk=com.mypackage
adb shell pm list packages -f -3

# pull the package off the device:
adb pull $(adb shell pm path "$TARGET" | cut -d':' -f2)

# disassemble the apk
apktool d -o output-dir base.apk

# AndroidManifest.xml
# android:debuggable="true"

# reassemble the application
apktool b -o "$TARGET".apk output-dir

# resign the APK so that the device will accept it:
keytool -genkey -v -keystore resign.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore resign.keystore com.mypackage.apk alias_name
